1. Overview

    Smart2 is a package manager that based on smart. Smart2 support all the 
    funtions of smart. In addition, smart2 has some new features.
  
    --------------
    New Features
    --------------

    - A new interface named "tgui" can show you a gui on your character 
    terminal.
    - Supports customizing your target rootfs on host development machine.
   
    ---------------------------------------------------------------------------
    NOTE:
    More informations about smart, please reference to doc/ or http://labix.org/smart/howto.
    ---------------------------------------------------------------------------
   
2. How to get smart2
  
    Smart2 now is managed on Github. You can get smart2 from there.
    https://github.com/ubinux/smart2.git

3. Installation

3.1 Dependencies

    1) The dependencies are same as smart

       Smart2 is based on smart, so please make sure the prerequisites for smart have been installed.
       Please refrence to http://labix.org/smart/howto to obtain details.

    2) Dependencies for smart2 new features.
       - python-newt:  the snack module depended by "tgui" graphic interface.

    ---------------------------------------------------------------------------
    NOTE:
        In some cases,  (e.g. Cross-Platform),  maybe you can not use the above command
      which belongs to host directly. You should build a special one for your target-platform,
      and make sure it's available in your toolchain for Cross-Platform.

      E.g, for Yocto user, you should install the toolchain firstly
    ---------------------------------------------------------------------------

3.2 Installation

    Cd into smart2 directory and execute the following commands as root:
    -------------------------------------------------------------------
    # python setup.py build
    # python setup.py install
    -------------------------------------------------------------------
    Or you can use the supplied Makefile:
    -------------------------------------------------------------------
    # make
    # make install
    -------------------------------------------------------------------

    -----------------------------------------------------------------------
    NOTE:
      After install you have to change the interpreter from "#!/usr/bin/python" to 
       "#!/usr/bin/env python" in your smart2 command.
    
      $ whereis smart
        smart: /opt/bin/smart
      $ cat /opt/bin/smart
        #!/usr/bin/env python
        ......
    -----------------------------------------------------------------------   

3.3 Global Setting

   1) In Cross-Platform case,  make sure the required commands can be invoked preferentially.
      For example, you can do it by the following command for Yocto-User
       # source TOOLCHAIN/environment-setup-i586-poky-linux

   2) Make sure the following environment variable point to correct path.
       # export RPM_USRLIBRPM=/usr/lib/rpm
       # export RPM_ETCRPM=/etc/rpm
       # export RPM_LOCALEDIR=/usr/share/locale

       -----------------------------------------------------------------------
        NOTE:
          In Cross-Platform case,  maybe you should customize these variable.
          E.g., for Yocto user, you should set them as following.

          # export RPM_USRLIBRPM=${OECORE_NATIVE_SYSROOT}/usr/lib/rpm
          # export RPM_ETCRPM=${SDKTARGETSYSROOT}/etc/rpm
          # export RPM_LOCALEDIR=${OECORE_NATIVE_SYSROOT}/usr/share/locale
       -----------------------------------------------------------------------

4. How to manage packages

    4.1 Setting

       A Cross-Platform user, will change to a specified path as the root directory of its target-platform.
       In this case, you should construct the environment before doing install/remove/search operations, 
       such as create rpm DB files.

       Smart2 provides a script to do it automaticly, it can help you to complete following jobs.
       - build pseudo environment
       - configure DB settings for packages sources(e.g. rpm, deb)
       - configure smart2 settings for packages sources(e.g. rpm,deb)
       - add channels

       Obtain details from help message
       -------------------------------------------------------------------
        $ ./enviroment-smart.sh --help

        usage:     . enviroment-smart.sh rootfs_dir packages_dir
        Add channels from the sources in packages_dir,and build the enviroment for target rootfs directory.

        #For example
        If you have packages of target(e.g. x86 packages created by Yocto):
             $ ls /home/test/x86_rpm/
             all  i586  qemux86
        And you want to manage(e.g. install/remove/search) these packages on your host machain.
        First, you should use the following command to set up your smart environment
             $ . enviroment-smart.sh /home/test/x86_rootfs /home/test/x86_rpm
        Then, you can manange target packages for target rootfs:
             $ smart --rootfs-dir=/home/test/x86-rootfs install pkgname
             $ smart --rootfs-dir=/home/test/x86-rootfs remove pkgname
             $ smart --rootfs-dir=/home/test/x86-rootfs query '*kgnam*'
        Or cutomize your rootfs:
             $ smart --rootfs-dir=/home/test/x86-rootfs --interface=tgui

        Note
        Smart mananges packages by repodate, make sure your repodate is correct with your packages.
             $ ls /home/test/x86_rpm/all/repodata
             filelists.xml.gz  other.xml.gz  primary.xml.gz  repomd.xml

       -------------------------------------------------------------------

    4.2 Create rootfs for Target-Platform
        
      Compart to smart, smart2 support a new interface named "tgui" which can 
      help you to customize your rootfs under character terminal of your 
      development machine.
	  
      You will enter the tgui insterface with the option "--interface=tgui".
      For example:
      -------------------------------------------------------------------
      $ smart --rootfs-dir=/home/test/x86-rootfs  --interface=tgui
	  -------------------------------------------------------------------
	  You can see the interface of tgui:
	  -------------------------------------------------------------------
	  1) Select install type
         Smart2 support 3 kinds of install. You can get details by enter "I" or "i" under the 
         following interface.

        ©°©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©È Select install type ©À©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©´
        ©¦                                                                                        ©¦
        ©¦ install all                                                                            ©¦
        ©¦ Busybox base                                                                           ©¦
        ©¦ customize                                                                              ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦ -------------------------------------------------------------------------------------- ©¦
        ©¦ SPACE/ENTER:select  I:Info  X:eXit                                                     ©¦
        ©¸©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¼

      2) Smart can help you filtering GPLv3.
	  
	         ©°©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©È License ©À©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©´
             ©¦                                          ©¦
             ©¦                                          ©¦
             ©¦  Do you want to install GPLv3 packages ? ©¦
             ©¦                                          ©¦
             ©¦                                          ©¦
             ©¦ ---------------------------------------- ©¦
             ©¦ Y:yes  N:no                              ©¦
             ©¸©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¼

      3) cutomize packages
        ©°©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©È Select package ©À©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©´
        ©¦                                                                                        ©¦
        ©¦ [ ] zip                                                                                ©¦
        ©¦ [ ] zabbix                                                                             ©¦
        ©¦ [ ] xz                                                                                 ©¦
        ©¦ [I] xwud                                                                               ©¦
        ©¦ [I] xwininfo                                                                           ©¦
        ©¦ [ ] xwd                                                                                ©¦
        ©¦ [ ] xvinfo                                                                             ©¦
        ©¦ [ ] xterm                                                                              ©¦
        ©¦ [ ] xstdcmap                                                                           ©¦
        ©¦ [ ] xsetroot                                                                           ©¦
        ©¦ [ ] xsetmode                                                                           ©¦
        ©¦ [ ] xset                                                                               ©¦
        ©¦ [*] xserver-xorg-xwayland                                                              ©¦
        ©¦ [*] xserver-xorg-xvfb                                                                  ©¦
        ©¦ [*] xserver-xorg-utils                                                                 ©¦
        ©¦ [*] xserver-xorg-module-libwfb                                                         ©¦
        ©¦ [*] xserver-xorg-module-libint10                                                       ©¦
        ©¦ [*] xserver-xorg-module-exa                                                            ©¦
        ©¦ [*] xserver-xorg-extension-glx                                                         ©¦
        ©¦ [*] xserver-xorg                                                                       ©¦
        ©¦ [*] xserver-xf86-config                                                                ©¦
        ©¦ [ ] xrestop                                                                            ©¦
        ©¦ [ ] xrefresh                                                                           ©¦
        ©¦ -------------------------------------------------------------------------------------- ©¦
        ©¦ All Package [2609]    Installed Packages [2609] Selected Packages [2609]               ©¦
        ©¦ -------------------------------------------------------------------------------------- ©¦
        ©¦ SPACE/ENTER:select/unselect  R:seaRch N:Next  B:Back  I:Info  X:eXit                   ©¦
        ©¸©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¼
        Note
        [] Means the package has not been selected and installed. If you want to install it, you can 
           select it by pressingt enter.
        [*] Means the package has been selcted and will be installed. If you don't want to install it,
           you can cancel by pressingt enter.
        [I] Means the package has been  installed in your rootfs. You can't select/unselect it in tgui.
           If you want to uninstall it.Please use the folowing command after exit tgui
           $ smart --rootfs-dir=/home/test/x86-rootfs remove pkgname
		   
      3) cutomize packages type
         You can select the package type that you want to install into rootfs.
        ©°©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©È customize special type packages ©À©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©´
        ©¦                                                                                        ©¦
        ©¦ locale []                                                                              ©¦
        ©¦ dev [ ]                                                                                ©¦
        ©¦ doc [ ]                                                                                ©¦
        ©¦ dbg [ ]                                                                                ©¦
        ©¦ staticdev [ ]                                                                          ©¦
        ©¦ ptest [ ]                                                                              ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦                                                                                        ©¦
        ©¦ -------------------------------------------------------------------------------------- ©¦
        ©¦ SPACE/ENTER:select/unselect  N:Next  B:Back  I:Info  X:eXit                            ©¦
        ©¸©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¼
		
      4) Confirm
	     After you confirm your customization:
        ©°©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©È Confirm install ©À©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©´
        ©¦                                          ©¦
        ©¦                                          ©¦
        ©¦  Do you want to begin installation?      ©¦
        ©¦                                          ©¦
        ©¦                                          ©¦
        ©¦ ---------------------------------------- ©¦
        ©¦ Y:yes  N:no                              ©¦
        ©¸©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¤©¼
        The installation will begin:
		-------------------------------------------------------------------
        Updating cache...                    ################################################# [100%]

        Committing transaction...
        Preparing...                         ################################################# [  0%]
        1:Installing lmsensors-config-f.. ################################################# [  0%]
        2:Installing qtbase-mkspecs       ################################################# [  0%]
        3:Installing glibc-localedata-t.. ################################################# [  0%]
        4:Installing glibc-charmap-gree.. ################################################# [  0%]
        5:Installing depmodwrapper-cross  ################################################# [  0%]
        ......
		
      -------------------------------------------------------------------
      5) Note

        To make sure the files in rootfs have correct uid and gid, notice that:
        * When rootfs is finished, please compress it into a tarball in the
          current terminal.For example:
          -------------------------------------------------------------------
          $ cd /home/test/
          $ tar jcvf x86-rootfs.tar.bz2 x86-rootfs
          -------------------------------------------------------------------
        * And when unpack rootfs on other terminal, please use sudo command with
          "--numeric-owner" option.For example:
          ------------------------------------------------------------------
          $ sudo tar vxf x86-rootfs.tar.bz2 --numeric-owner
          -------------------------------------------------------------------
    
    4.3 Smarts Commands
	 
      Beside "tgui", you also can manage packages by command line with the option 
      "--rootfs-dir".
      For example:
      -------------------------------------------------------------------
      $ smart --rootfs-dir=/home/test/x86-rootfs install pkgname
      $ smart --rootfs-dir=/home/test/x86-rootfs remove pkgname
      $ smart --rootfs-dir=/home/test/x86-rootfs query '*kgnam*'
      -------------------------------------------------------------------
      More commands please reference to doc/ or http://labix.org/smart/howto.
  		

